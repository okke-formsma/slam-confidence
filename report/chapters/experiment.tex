%!TEX root = ../report.tex
\chapter{Experiments}
\label{experiments}
In this chapter the experimental results are outlined. The experimental method is outlined in chapter~\ref{method}. For the experiment, a number of simulation runs are recorded in USAR Sim. The map is then 

\section{Experimental Runs}
\subsection{Map 1: IranOpen 2012 - Pre 2}
This map was used in the Iran Open 2012 competition \cite{iran2012}. The map features a grey hospital-like environment with grey tiled floors and walls. In figure~\ref{fig:map1} a screenshot of the environment is shown along with the map after the Weighted Scan Matcher was run on the simulation data. 

\begin{figure}[ht]
\centering
\subfigure[Screenshot]{
	\includegraphics[width=0.5\textwidth]{images/experiment/map1/screenshot.png}
	\label{fig:map1-screenshot}
}
\subfigure[Map created with the WSM]{
	\includegraphics[width=0.3\textwidth]{images/experiment/map1/slam.png}
	\label{fig:map1-map}
}
  \caption{The ground truth, inertia sensor and slam path of the robot on a piece of map 1.}
  \label{fig:map1}
\end{figure}

The map shows a lot of noise and errors. As can be seen in figure~\ref{fig:apx:map1-paths} (in the appendix), the inertia sensor gives a rather good location-estimate, but the rotation estimate from position 160 onwards is off by more than $10\degree$. The scanmatcher fails regularly because it takes the inertia sensor location estimate as begin point for its search. When the location according to SLAM and inertia sensor diverge too far, the SLAM matcher fails -- it only searches a local neighborhood around the initial seed pose given by the inertia sensor. The result of this is a map with jagged lines, as can be seen in figure~\ref{fig:map1-map} and figure~\ref{fig:map1}.

\begin{figure}[ht]
  \centering
  \includegraphics[width=0.7\textwidth]{images/experiment/map1/ins-problem.pdf}
  \caption{A small part of the path the robot moved in map 1. The wrong rotation estimate of the inertia sensor (yellow line) makes the slam-matcher (red line) think the robot moved in another direction than it did in reality (blue line). When the inertia sensor reading and SLAM result diverge too far, the SLAM location is reset to the inertia sensor estimate. This results in a jagged path estimate from the SLAM sensor.}
  \label{fig:map1-ins-problem}
\end{figure}

\subsection{Map 2}
Gotta make a second run.

\subsection{Map 3}
Gotta make a third run.

\section{Segmenting the map}
The confidence measures of the first map are shown in figure~\ref{fig:map1-confidence-measures-vs-time}. It is immediately apparent that the extreme values of the three metrics coincide. When the scan matcher matches few scanlines, the determinant and trace values are at their maximum. When the scan matcher matches no scanlines, the determinant and trace of the covariance matrix are undefined. These show up as red dots on the x-axis. When the scan matcher matches many scanlines, its increased confidence in a correct match is reflected in a covariance matrix with small determinant and trace.

In figure~\ref{fig:map1-confidence-measures-scatter} the values of the three confidence measures are plotted against each other to emphasize their correlation. The (Spearman) rank correlation gives an indication how well the relationship between the two variables can be described by a monotonic function. The spearman rank correlation coefficients between the confidence measures is as follows. Between trace and determinant $0.85$, between number of matches and determinant $-0.50$, and between number of matches and trace $-0.48$, all with a p-value $\ll 10^{-10}$. This means that all three confidence measures are strongly correlated.

\begin{figure}[ht]
  \centering
  \subfigure[Confidence measures through time]{
    \includegraphics[width=\textwidth]{images/experiment/map1/error-measures.pdf}
    \label{fig:map1-confidence-measures-vs-time}
  }
  \subfigure[Scatter plot between the three confidence measures.]{
    \includegraphics[width=\textwidth]{images/experiment/map1/error-measures-scatter.pdf}
    \label{fig:map1-confidence-measures-scatter}
  }
  \caption{Confidence measures for map 1.}
  \label{fig:map1-confidence-measures}
\end{figure}

When there are no matches at all, the scanmatcher has failed most spectacularly. In that case, the covariance matrix can not even be computed. In extention, the determinant or trace of the covariance matrix can not be computed either. This occurs at the following timesteps: 66  67  68  96 103 113 159 164 168 175. The greatest rift lies at $66 \le t \le68$, where there were 3 consecutive timesteps that could not be matched. 



\section{Stitching}

\section{Results}